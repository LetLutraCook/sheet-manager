<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>sheet manager</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; margin-top: 20px; }
    td, th { border: 1px solid #ccc; padding: 6px 10px; }
    button { margin-top: 20px; padding: 8px 14px; }
  </style>
</head>

<body>
  <h2>sheet manager</h2>

  <button onclick="loadSheet()">Load Sheet</button>
  <button onclick="saveSheet()">Save Sheet</button>

  <table id="sheet"></table>

  <script>
    const URL = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLjd_9dIBJsLAQQy14z-ppCin3nk-0abs1sOQwrbGfIrukKabAr5uPVZUrYAgShbszC3Xo7NzQR7P8kMxfNd6L2DsoGx1pzZkpKQ25NbkArgujMhoPSUDyLT3cPljiW_sPsAWDAFB5XqQ297UryoevY-0cEx3ZezT8trhJ04DW5aDArEJaDo46nwWSExhEYgF3LNs1oNe8M7GEmYSw8lVij6foj3GXp4mpKgxRXpJn-b-qZ0ghSPBSEuXIhzk1BjKyT0R-_ytY2OwZ2XS9GNFgxXycO0GwfggQ6IQlao&lib=MmnhR7btKInj58QZjGZ_D-ko5nz9syJhs";

    async function loadSheet() {
      const res = await fetch(URL);
      const data = await res.json();
      renderTable(data);
    }

    function renderTable(data) {
      const table = document.getElementById("sheet");
      table.innerHTML = "";

      data.forEach((row, r) => {
        const tr = document.createElement("tr");

        tr.style.backgroundColor = r % 2 === 0 ? "#ffffff" : "#f2f2f2";

        row.forEach((cell, c) => {
          const td = document.createElement("td");

          const isHeaderRow = r === 0;
          const isHeaderCol = c === 0;

          if (isHeaderRow || isHeaderCol) {
            td.textContent = cell;
          } else {
            const input = document.createElement("input");
            input.value = cell;
            input.dataset.r = r;
            input.dataset.c = c;
            td.appendChild(input);
          }

          tr.appendChild(td);
        });

        table.appendChild(tr);
      });
    }

    async function saveSheet() {
      const inputs = document.querySelectorAll("input");
      const rows = [];

      inputs.forEach(input => {
        const r = Number(input.dataset.r);
        const c = Number(input.dataset.c);
        if (!rows[r]) rows[r] = [];
        rows[r][c] = input.value;
      });

      await fetch(URL, {
        method: "POST",
        body: JSON.stringify(rows)
      });

      alert("Saved");
    }
  </script>
</body>
</html>
