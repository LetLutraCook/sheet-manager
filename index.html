<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>sheet manager</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; margin-top: 20px; }
    td, th { border: 1px solid #ccc; padding: 6px 10px; }
    button { margin-top: 20px; padding: 8px 14px; }
  </style>
</head>

<body>
  <h2>sheet manager</h2>

  <button onclick="loadSheet()">Load Sheet</button>
  <button onclick="saveSheet()">Save Sheet</button>

  <table id="sheet"></table>

  <script>
    const URL = "https://script.google.com/macros/s/AKfycbxlJFQbLvtzRqd1ZYIG2n-d98gKyRPDwt-Vf2vMq11mrPRprnUYL3x72Se2Kqtm6ZTbPQ/exec";

    async function loadSheet() {
      const res = await fetch(URL);
      const data = await res.json();
      renderTable(data);
    }

    function renderTable(data) {
      const table = document.getElementById("sheet");
      table.innerHTML = "";
      data.forEach((row, r) => {
        const tr = document.createElement("tr");
        row.forEach((cell, c) => {
          const td = document.createElement("td");
          const input = document.createElement("input");
          input.value = cell;
          input.dataset.r = r;
          input.dataset.c = c;
          td.appendChild(input);
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
    }

    async function saveSheet() {
      const inputs = document.querySelectorAll("input");
      const rows = [];

      inputs.forEach(input => {
        const r = Number(input.dataset.r);
        const c = Number(input.dataset.c);
        if (!rows[r]) rows[r] = [];
        rows[r][c] = input.value;
      });

      await fetch(URL, {
        method: "POST",
        body: JSON.stringify(rows)
      });
    }
  </script>
</body>
</html>
